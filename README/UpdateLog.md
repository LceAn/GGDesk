## 📝 完整更新日志
### [2025-11-19] Beta 4.7.1 - 详情页布局微调 (Layout Tweak)

**🎨 界面美化 (UI Improvements)**

  * **Header Layout**: 将详情修改窗口（RefineWindow）头部的程序名称和路径改为 **水平单行排列 (Horizontal)**。左侧显示粗体程序名，右侧显示灰色路径，既节省了垂直空间，又使信息展示更加紧凑和专业。

**✨ 体验提升 (UX Polish)**

  * 路径文字颜色调淡，形成清晰的视觉层级，避免喧宾夺主。
### [2025-11-19] Beta 4.7 - 详情页交互升级 (Detail View UX)

**✨ 详情弹窗重构 (Refine Window Refactor)**

  * **美化布局**: 引入了一个淡灰色的头部信息栏，清晰展示当前正在编辑的程序名称和根目录，视觉上更加现代、专业。
  * **实时计数**: 底部工具栏新增“已选 X / 可见 Y (共 Z)”的动态计数器，在搜索筛选和勾选操作时实时更新，数据一目了然。
  * **双击操作**: 优化了列表交互，现在**双击**任意行即可快速反转该项的选中状态，无需精确点击 Checkbox 或使用 Ctrl+Click，操作效率大幅提升。
  * **图标优化**: 将文件图标移至第一列（程序名），与主界面保持一致的视觉语言。
### [2025-11-19] Beta 4.6 - 结果反馈优化 (Feedback Polish)

**✨ 交互体验 (UX Improvements)**

  * **美化生成成功弹窗 (Success Dialog)**:
      * 弃用了系统原生的 MessageBox，改用自定义设计的 `GenSuccessDialog`。
      * 弹窗包含醒目的成功图标、生成数量统计。
      * **新增功能**: “📂 打开生成目录”按钮，允许用户生成后一键直达目标文件夹，极大提升了操作流的连贯性。

**💻 技术细节 (Technical)**

  * **Backend Expansion**: 新增 `open_file_explorer` 函数，封装了 `os.startfile` 以支持在 Windows 资源管理器中打开路径。
  * **UI Customization**: `GenSuccessDialog` 继承自 `QDialog`，并移除了默认的问号帮助按钮，界面更清爽。
### [2025-11-19] Beta 4.5.1 - 状态显示微调 (Status Polish)

**✨ 界面优化 (UI Improvements)**

  * **状态列可读性**: 将“状态”列的显示方式从单 Emoji 图标 (`🆕`) 更新为 **Emoji + 文本** (`🆕 新增` / `✅ 已存在`)。这使得程序状态一目了然，减少了用户的认知负担，同时保留了 Tooltip 的详细说明功能。

### [2025-11-19] Beta 4.5 - 体验打磨与引导优化 (UX Polish & Guide)

**✨ 界面与引导 (UI/UX Guidance)**

  * **顶部说明板块 (Info Bar)**:
      * 在扫描结果列表上方新增了一个淡雅的蓝色提示条。
      * 提供简明的操作指引（双击修改、颜色含义），降低用户的学习成本。
  * **状态列人性化 (Status UX)**:
      * 将生硬的文字状态（“已存在”）替换为直观的 Emoji 图标（🆕 / ✅）。
      * 增加了 **Tooltip (悬停提示)**，鼠标指向状态图标时会显示详细解释（例如显示冲突的具体路径）。

**🔧 布局修复 (Layout Fixes)**

  * **侧边栏排版**: 修复了侧边栏底部“By LceAn”归属信息可能出现的错位或挤压问题。通过增加弹性空间 (`addStretch`) 和底部留白，使其视觉上更加稳重、美观。

**💻 代码优化 (Technical)**

  * **QSS Scope**: 为提示条引入了独立的 CSS ID 选择器 (`#infoFrame`)，确保样式只影响该特定组件，不污染全局设置。
### [2025-11-19] Beta 4.4 - 智能查重与状态管理 (Conflict Detection)

**🔍 智能查重 (Smart Detection)**

  * **功能描述**: 在扫描完成后，程序会自动扫描当前的“生成路径”，对比新扫描到的程序与现有快捷方式。
  * **比对逻辑 (Logic)**: 采用 **目标路径比对 (Target Path Match)**。如果发现已存在的快捷方式指向完全相同的 `.exe` 路径，则判定为“已存在”。
  * **后端支持**: `backend.normalize_path` 提供了标准化的路径处理，确保忽略大小写和路径分隔符差异。

**🚦 状态可视化 (Visual Status)**

  * **状态列 (Status Column)**: 列表新增“状态”列。
      * **🆕 新增**: 绿色文字，默认 **勾选**。
      * **✅ 已存在**: 灰色文字，默认 **不勾选**。
  * **体验提升**: 这一机制防止了用户重复生成相同的快捷方式，大大减少了冗余操作。

**🛡️ 生成保护 (Safety Check)**

  * **覆盖警告**: 在点击生成时，如果选中的项目会导致现有快捷方式被覆盖（文件名冲突），会弹出确认对话框，防止误操作。
### [2025-11-19] Beta 4.3.3 - 工程模块化重构 (Component Separation)

**🧱 架构重构 (Architectural Overhaul)**

  * **UI 组件拆分**: 将庞大的 `scanner_ui.py` 拆解为独立的模块，极大地提升了代码的可维护性和扩展性。
      * `ui/page_scan.py`: 负责扫描逻辑、工作线程和详情弹窗。
      * `ui/page_output.py`: 负责输出路径管理和现有快捷方式预览。
      * `ui/page_filter.py`: 负责黑名单和忽略目录管理。
      * `ui/page_settings.py`: 负责主题切换和日志显示。
      * `ui/main_window.py`: 负责整体布局框架和页面间的信号调度。
  * **信号驱动通信 (Signal-Driven)**: 页面之间不再直接调用（低耦合），而是通过 Signal/Slot 机制在 `MainWindow` 中进行消息转发（如：路径修改同步、日志记录）。

**✨ 功能保持**: 保持了 Beta 4.3.2 的所有功能和修复，仅在代码结构层面进行了彻底的现代化改造。

### [2025-11-18] Beta 4.3 - 架构扩展与全选优化

**🧱 架构扩展 (Architecture Expansion)**

  * **独立输出管理页 (Output View)**:
      * 侧边栏新增一级菜单 **“生成路径”**。
      * 将输出路径设置从“系统设置”中剥离，提供更专注的管理界面。
      * **实时预览**: 新增“当前路径下已存在的快捷方式”列表，支持实时扫描和展示，为后续的“重复检测 (Beta 4.4)”做好数据准备。

**✨ 交互体验优化 (UX)**

  * **原生全选列头 (Native Header Checkbox)**:
      * 移除 Beta 4.2 中临时的复选框控件。
      * 在列表的“程序名称”列头直接集成复选框。点击列头即可实现全选/反选，操作逻辑更符合原生系统体验。
      * 修复了全选操作导致列表刷新异常（空白）的 Bug。
  * **文案复原**: 扫描页顶部提示语恢复为“发现结果 (双击修改...)”，保持界面简洁。

**💻 技术细节 (Technical)**

  * **Backend**: 新增 `scan_existing_shortcuts` 函数，利用 `WScript.Shell` 解析现有 `.lnk` 文件的目标路径。
  * **Event Handling**: 通过监听 `QHeaderView` 的 `itemClicked` 信号来实现列头复选框的逻辑，并使用 `blockSignals` 优化批量更新时的性能。

### [2025-11-18] Beta 4.2 - 细节打磨与品牌化 (Refining & Branding)

**✨ 交互体验 (UX Improvements)**

  * **全选/计数联动 (Selection Control)**:
      * 列表头新增 **“全选列表”** 复选框，一键管理所有扫描结果。
      * 列表头右侧新增 **实时计数器** (`已选 X / 共 Y 个`)，根据用户的勾选操作动态刷新，数据展示更直观。
  * **生成路径提示 (Path Hint)**:
      * “生成”按钮上方新增淡雅的路径提示文字 (`将生成至: ...`)。
      * 该提示会实时同步“应用设置”中的路径修改，防止用户误操作。

**🎨 界面微调 (UI Tweaks)**

  * **归属信息 (Attribution)**: 侧边栏底部版本号下方新增 **"By LceAn"** 署名，字体采用更细腻的层级处理（更小、更淡）。
  * **布局优化**: 优化了头部和底部的间距与对齐，使界面看起来更紧凑、专业。

**💻 技术细节 (Technical)**

  * **Signal Blocking**: 在执行批量全选操作时，暂时屏蔽 `itemChanged` 信号，避免触发成百上千次重复计算，保证 UI 流畅度。
  * **Dynamic Linking**: 实现了 `Settings` 页面的路径输入框与 `Scanner` 页面的路径提示标签之间的实时信号连接。

### [2025-11-18] Beta 4.1 - 智能分词算法与交互微调

**🧠 算法核心升级 (Algorithm)**

  * **分词加权匹配 (Token Scoring)**:
      * 解决了 `IntelliJ IDEA` 无法识别 `idea64.exe` 的问题。
      * 新算法将程序名拆解为特征词 (Tokens)，如 `['intellij', 'idea']`，如果文件名匹配任意特征词，给予 **+150分** 的极高权重。
      * **效果**: 完美修复了 JetBrains 全家桶及其他缩写类程序的识别准确率，彻底压制了 `launcher.exe` 等通用名的权重。

**✨ 交互体验优化 (UX)**

  * **复选框支持 (Batch Selection)**:
      * 程序列表第一列新增复选框。
      * 用户现在可以手动取消勾选不需要的程序，生成按钮只会处理被勾选的项目。
  * **图标归位**: 程序图标已移至 **第 2 列 (推荐执行文件)**，逻辑上更符合直觉（因为图标属于那个 .exe 文件）。
  * **工具提示 (Tooltips)**: 鼠标悬停在列表项上时，会显示完整的文件路径，解决了路径过长显示不全的问题。

**💻 技术细节 (Technical)**

  * **Scanner UI**: 重构了 `generate` 函数，改为遍历 `QTreeWidget` 的 `CheckState` 状态来决定是否创建快捷方式。

### [2025-11-18] Beta 4.0 - 工程重构与模块化

**🧱 架构重构 (Architecture & Refactoring)**

  * **模块化拆分 (Modularization)**: 将单文件项目拆分为标准的 Python 模块结构。
      * `scanner_backend.py`: 核心业务逻辑与 I/O。
      * `scanner_ui.py`: GUI 界面与线程控制。
      * `scanner_styles.py`: 独立的 QSS 样式表文件。
      * `main.py`: 干净的程序入口。
  * **文件结构优化**: 明确了配置文件的生成规则，项目根目录更加清晰。

**✨ 新增功能 (New Features)**

  * **独立过滤规则菜单 (Filters Menu)**: 在侧边栏新增“过滤规则”页面，将文件黑名单与目录黑名单管理从系统设置中分离。
  * **黑洞目录管理 (Blackhole Dirs UI)**: 新增 `ignored_dirs.txt` 的可视化编辑功能。用户现在可以在界面上直接查看和修改需要跳过的目录列表，实时优化扫描性能。
  * **Splitter 布局**: 过滤规则页面采用 `QSplitter` 左右分栏布局，方便同时对比和编辑两类规则。

**💻 技术细节 (Technical)**

  * **Config Persistence**: 新增 `ignored_dirs.txt` 的自动加载与保存逻辑。
  * **Refactoring**: 从 UI 代码中移除了硬编码的 CSS 字符串，提高了代码的可读性与可维护性。


### [2025-11-18] Beta 3.2 - 性能专项优化

**⚡ 性能优化 (Performance Optimization)**

  * **黑洞目录剪枝 (Directory Pruning)**:
      * 在后端扫描逻辑中引入了 `IGNORED_DIRS` 机制。
      * 程序现在会自动识别并**完全跳过** `node_modules`, `.git`, `venv`, `Windows`, `ProgramData` 等庞大且无关的目录。
      * **效果**: 在扫描开发环境（包含大量 `node_modules`）或系统盘根目录时，扫描速度提升了 **10倍以上**，并有效避免了无意义的权限错误。

**💻 技术细节 (Technical)**

  * **Algorithm**: 在 `os.walk` 循环中利用 `topdown=True` 特性，通过原地修改 `dirs` 列表 (`dirs[:] = ...`) 来物理阻止递归进入指定目录，这比遍历后再过滤要高效得多。

### [2025-11-18] Beta 3.1 - 智能算法与现代 UI

**🧠 核心升级 (Core Enhancements)**

  * **智能评分算法 (Smart Ranking)**: 后端 `scanner_backend.py` 引入了全新的评分机制。不再简单地返回第一个 .exe，而是根据“文件名匹配度”、“目录深度”、“常见启动关键词 (launcher, main)”等维度进行加权打分，大幅提高了自动识别主程序的准确率。
  * **算法逻辑优化**: 优化了目录遍历和分组逻辑，减少了对系统文件的无效扫描。

**🎨 界面现代化 (Modern UI / Fluent Design)**

  * **卡片式布局**: 采用灰白/深灰对比色，将主内容区设计为悬浮卡片样式，增强视觉层次感。
  * **圆角与间距**: 全面增加控件的 `border-radius` 和 `padding`，按钮和输入框更加圆润、舒适。
  * **图标化导航**: 侧边栏按钮增加图标支持，使用 Qt 标准图标库，界面更加直观生动。
  * **状态栏反馈**: 底部增加状态栏和进度条动画，在扫描时提供清晰的“繁忙”反馈。

**✨ 体验优化 (UX Improvements)**

  * **主列表图标**: 程序列表现在会提取并显示 .exe 文件的真实图标，极大地提升了辨识度。
  * **双击交互**: 完善了双击列表项打开“详情修改”窗口的逻辑。
  * **设置持久化**: 完善了对上次扫描路径、输出路径、主题偏好、窗口大小的自动保存与加载。

**🐛 Bug Fixes**

  * 修复了多线程停止时可能导致的状态栏文字滞留问题。
  * 修复了黑名单保存时未去除空行的问题。

### [2025-11-18] Beta 3.0 - 交互体验与视觉升级



*(注：这是刚才完成的最新版本)*

- **✨ New Features:**
  - **图标支持**：程序列表现在显示 `.exe` 文件的原生图标 (`QFileIconProvider`)。
  - **扫描控制**：新增“开始/停止”按钮，支持随时中断扫描任务。
  - **主题切换**：内置“暗黑/明亮”两种主题，支持在设置中动态切换。
  - **交互优化**：支持双击列表项直接修改详情；移除 "Stage 1/2" 术语。
  - **路径自定义**：支持自定义快捷方式生成的输出目录。
- **🛠️ Fixes:**
  - 修复了扫描时 UI 冻结的问题（继承自 Beta 2 的多线程架构）。
  - 首页移除冗余日志，改为状态栏显示。

------



### [2025-11-18] Beta 2 (v8.3 - v8.4.1) - 架构重构与多线程



- **🚀 Architecture:**
  - **UI 布局重构 (v8.3)**：弃用垂直布局，引入 **Sidebar (侧边栏) + StackedWidget (多页面)** 的现代应用布局。
  - **多线程扫描 (v8.4)**：引入 `QThread` 和 `Worker` 模式，将 I/O 扫描任务移出主线程，彻底解决扫描大目录时界面卡死 (Not Responding) 的问题。
- **🐛 Bug Fixes:**
  - **v8.4.1 Hotfix**：修复了多线程下对象生命周期管理错误导致的 `0xC0000409` 堆栈崩溃问题（Race Condition）。
  - 修复了 `super().__init__()` 在 `QObject` 子类中缺失导致的对象未初始化问题。
- **🔧 Improvements:**
  - 引入 `Logger` 信号机制，实现跨线程日志安全传输。
  - 将“黑名单管理”移至独立的设置页面。

------



### [2025-11-18] Beta 1 (v8.0 - v8.2) - 技术栈迁移 (Tkinter to Qt)



- **⚡ Framework Switch:**
  - **弃用 Tkinter**：由于原生控件限制和美化困难，完全移除 Python 内置 Tkinter 库。
  - **引入 PySide6 (Qt)**：采用工业级 GUI 框架重写所有前端代码，支持更丰富的控件和样式表 (QSS)。
- **🧱 Core Logic:**
  - **前后端分离 (v8.1)**：将核心业务逻辑剥离为独立的 `scanner_backend.py` 模块，实现逻辑复用。
  - **配置文件集成**：引入 `config.ini`，实现对窗口大小、上次扫描路径的持久化存储。
- **🎨 UI/UX:**
  - **QSS 样式表 (v8.2)**：首次引入类似 CSS 的样式定义，实现基础的“暗黑模式”外观。
  - 使用 `QTreeWidget` 替代 `ScrolledText`，实现原生的多列列表和列排序功能。

------



### [2025-11-18] Alpha Phase (v1 - v7) - 原型验证与逻辑探索



- **v7 (Discovery Logic)**：
  - **程序发现算法**：也就是“两级火箭”逻辑。不再简单罗列所有 `.exe`，而是智能识别“程序根目录”并分组展示。
  - **启发式匹配**：实现了基于文件夹名称的关键词匹配算法，自动建议主程序（如在 `CLion/.../bin` 中自动选中 `clion64.exe`）。
- **v4 - v6 (Tkinter Demo)**：
  - **v6**：尝试基于文件大小的过滤逻辑（已废弃，被 v7 启发式取代）。
  - **v5**：实现了基础的 GUI 界面，支持全选/反选、查看黑名单。
  - **v4**：实现了日志在界面内的实时输出。
- **v1 - v3 (Scripting)**：
  - **v3**：首次引入 GUI (Tkinter)。
  - **v2**：引入“黑名单”机制，过滤 `uninstall.exe` 等无关文件。
  - **v1**：基于 `pywin32` 的概念验证脚本，实现基本的快捷方式创建功能。